// admin-scripts/upload-data.js

// 1. ุฏู ููุชุจุฉ ุจูุณุชุฎุฏููุง ุนุดุงู ููุฏุฑ ูุชุนุงูู ูุน Firebase ูู ุฎูุงู ููุฏ Node.js
const admin = require('firebase-admin');

// 2. ููุง ุจูููู ููุจุฑูุงูุฌ ููู ููุงูู ุงูููุชุงุญ ุจุชุงุน ูุดุฑูุนู ูู Firebase.
// ุงูุณุทุฑ ุงููู ุฌุงู ุฏู ููู ุฌุฏุงู: ูุงุฒู ุงุณู ุงูููู ุงููู ุจูู ุงูููุณูู ูููู ูู ูู ุจุงูุธุจุท ุงุณู ููู ุงูููุชุงุญ ุงููู ุฃูุช ุญุทูุชู ุฌูุจ ุงูููู ุฏู.
// ุฃูุช ูููุชูู ุงุณู ุงูููู ุฏู: students-platform-d3b22-firebase-adminsdk-fbsvc-ff1cdfe181.json
// ูุจูู ูุชูุชุจู ุจุงูุธุจุท ููุง:
const serviceAccount = require('./students-platform-d3b22-firebase-adminsdk-fbsvc-ff1cdfe181.json');

// 3. ุงูุณุทุฑ ุฏู ุจูุดุบู ุงุชุตุงููุง ุจู Firebase ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุจุชุงุนู.
admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});

// 4. ุงูุณุทุฑ ุฏู ุจูุฎูููุง ููุฏุฑ ูุชุนุงูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช Firestore ุจุชุงุนุชูุง.
const db = admin.firestore();

// 5. ููุง ุจูุฌูุจ ุจูุงูุงุช ุงูููุฑุณุงุช ุงููู ุฃูุช ูุงุชุจูุง ูู ููู courses-data.js
// ุนุดุงู ุงูุณุทุฑ ุฏู ูุดุชุบู ุตุญุ ูุงุฒู ูุนูู ุชุนุฏูู ุจุณูุท ุฌุฏุงู ูู ููู "js/courses-data.js" ุจุชุงุนู.
// (ููููู ุฅุฒุงู ุชุนุฏูู ูู ุงูุฎุทูุฉ ุงููู ุฌุงูุฉ ุฏู ุจุงูุธุจุท)
const { courses } = require('../js/courses-data.js'); 

// 6. ุฏู ููุฏ ุงูุทุงูุจ ุงููู ููุฑูุน ูู ุงูุจูุงูุงุช (ูุงุฒู ูููู ูู ูู ุงููู ุฃูุช ุฏุฎูุชู ูู Firebase ูุฏููุงู).
const studentCode = '1001'; 

// 7. ุฏู ูุธููุฉ (ุฏุงูุฉ) ููุนูููุง ุนุดุงู ุชุฑูุน ุงูุจูุงูุงุช ูู Firebase.
async function uploadStudentData() {
  try {
    // ุจูุญุฏุฏ ููู ููุญุท ุงูุจูุงูุงุช ูู Firebase (ูู ูุฌููุนุฉ ุงุณููุง "students" ูุฌูุงูุง ูุณุชูุฏ ุงุณูู "1001")
    const studentRef = db.collection('students').doc(studentCode);

    // ููุง ุจูููู ูู Firebase "ุฎุฏ ุงูุจูุงูุงุช ุฏู ูููุง ูุญุทูุง ูู ุงููุณุชูุฏ ุฏู"
    // ูู ุงููุณุชูุฏ ููุฌูุฏุ ููุญุฏุซู ุจุงูุจูุงูุงุช ุฏู. ูู ูุด ููุฌูุฏุ ููุนููู.
    await studentRef.set({
      name: 'ุณุงุฑุฉ ูุญูุฏ ุฌูุงู', // ููุง ูููู ุชุบูุฑ ุงุณู ุงูุทุงูุจ ุงููู ููุธูุฑ ูู ุงูุชุทุจูู
      courses: courses // ููุง ุงูุณูุฑูุจุช ุจูุงุฎุฏ ูู ุชูุงุตูู ุงูููุฑุณุงุช ูู ููู courses-data.js
    });

    // ุงุจุฏุฃ ูู ููุง ุฅุถุงูุฉ ุงูููุฏ ุงูุฌุฏูุฏ
// -------------------------------------------------------------
// ูุฐุง ุงูุฌุฒุก ูููู ุจุฑูุน ูู ููุฑุณ (ุจูุง ูู ุฐูู ุงููุงุฌุจุงุช ูุงูุงุฎุชุจุงุฑุงุช)
// ุฅูู ูุฌูุฏ 'courses' ุงููููุตู ูู Firebase.
for (const courseId in courses) {
  const courseData = courses[courseId];
  await db.collection('courses').doc(courseId).set(courseData);
  console.log(`โ ุชู ุฑูุน ุงูููุฑุณ "${courseData.title}" ุฅูู collection 'courses'.`);
}
// -------------------------------------------------------------
// ุงูุชูู ุงูููุฏ ุงูุฌุฏูุฏ

    // ูู ูู ุญุงุฌุฉ ุชูุงูุ ูุชุธูุฑ ุงูุฑุณุงูุฉ ุฏู ูู ุงูุดุงุดุฉ
    console.log(`๐ ุจูุงูุงุช ุงูุทุงูุจ ${studentCode} ุชู ุฑูุนูุง ุจูุฌุงุญ ูุน ุฌููุน ุงูููุฑุณุงุช!`);
  } catch (error) {
    // ูู ููู ุฃู ูุดููุฉุ ูุชุธูุฑ ุฑุณุงูุฉ ุงูุฎุทุฃ ุฏู
    console.error('โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฑูุน ุงูุจูุงูุงุช:', error);
  }
}

// 8. ุงูุณุทุฑ ุฏู ุจูุดุบู ุงููุธููุฉ ุงููู ุนูููุงูุง ููู ุนุดุงู ุชุจุฏุฃ ุชุฑูุน ุงูุจูุงูุงุช.
uploadStudentData();